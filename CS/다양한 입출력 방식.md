# 다양한 입출력 방식

입출력방식은 프로그램 입출력, 인터럽트 기반 입출력, DMA입출력 세가지로 나눌 수 있다.

<br>

## 1. 프로그램 입출력

<br>

프로그램 속 명령어로 입출력 장치를 제어하는 방법이며, 입출력 명령어로써 장치 컨트롤러와 상호작용한다. 메모리에 저장된 정보를 하드 디스크에 백업하는 것은 하드디스크에 새로운 정보를 쓰는 작업이라고 할 수 있다.

<br>

### 1-1 cpu는 하드 디스크 컨트롤러의 제어 레지스터에 쓰기 명령을 내보낸다.

### 1-2 하드 디스크 컨트롤러는 하드 디스크 상태를 확인하여 문제 없을 경우 상태 레지스터에 준비완료 표시를 한다.

### 1-3 cpu는 상태 레지스터를 주기적으로 읽어보며 하드 디스크의 준비여부를 확인하며, 확인된 경우 백업할 메모리의 정보를 데이터 레지스터에 쓴다.

<br>

프로그램 입출력 방식은 cpu가 장치 컨트롤러의 레지스터 값을 읽고 씀으로서 이루어진다고 할 수 있다.
cpu가 장치 컨트롤러의 레지스터에 접근하기 위해서 두가지 방법을 사용한다.

<br>

### 메모리 맵 입출력 

<br>

메모리에 접근하기 위한 주소 공간과 입출력장치에 접근하기 위한 주소공간을 하나의 주소공간으로 간주하는 방법이다.

<br>

### 고립형 입출력 

<br>

메모리를 위한 주소 공간과 입출력 장치를 위한 주소 공간을 분리하는 방법이다.

<br>

|메모리 맵 입출력|고립형 입출력|
|---------------|------------|
|메모리와 입출력장치는 같은 주소 공간 사용|메모리와 입출력장치는 분리된 주소 공간 사용|
|메모리 주소 공간이 축소됨|메모리 주소 공간이 축소되지 않음|
|메모리와 입출력장치에 같은 명령어 사용 가능|입출력 전용 명령어 사용|

<br>

## 2. 인터럽트 기반 입출력

<br>

cpu가 장치 컨트롤러의 상태 레지스터를 주기적으로 확인하지 않고, 장치 컨트롤러가 준비될 경우 장치컨트롤러가 인터럽트를 통해 cpu에게 요청을 보내도록 할 수 있다.

cpu는 요청이 오기 전까지 상태 레지스터를 확인하지 않아도 되기 때문에 보다 효율적으로 일을 수행할 수 있다.

여러개의 입출력장치를 사용함으로 인해 동시 다발적인 인터럽트에 대해 요청처리방법은 들어오는 요청처리 순서대로 처리할 수 있겠지만 완벽하진 않다. 

그 이유는 인터럽트 중에서도 늦게 요청이 들어왔지만 빨리 처리해야하는 인터럽트가 존재하기 때문이다.

이럴 경우 사용되는 방법은 다양하게 있지만 많이 사용되는 방법은 PIC (Programmable interrupt Controller)를 사용하여 인터럽트를 처리하는 방법이다.

pic 는 여러 장치 컨트롤러에 연결되어 장치 컨트롤러의 하드웨어 인터럽트의 우선순위 (중요도) 를 판단한 뒤 cpu에게 지금 처리해야하는 인터럽트가 무엇인지 판단하여 알려주는 하드웨어이다.

프로그램 입출력, 인터럽트 기반의 입출력의 공통점은 입출력장치와 메모리 간의 데이터 이동은 cpu가 주도하고 이동하는 데이터도 반드시 cpu를 거친다는 것이다.

<br>

## 3. DMA 입출력

<br>

DMA는 Direct Memory Access의 약자이며 cpu를 거치지 않고 입출력장치가 메모리에 직접적으로 접근하는 입출력 방식을 말한다. DMA 입출력 과정은 다음과 같다.

<br>

### 1. cpu는 DMA 컨트롤러에 입철력 작업을 명령한다.
### 2. DMA 컨트롤러는 cpu 대신 장치 컨트롤러와 상호작용하며 입철력 작업을 수행한다.
### 3. 입출력 작업이 끝나면 DMA 컨트롤러는 인터럽트를 통해 cpu에 작업이 끝났음을 알린다.

<br>

DMA 입출력을 사용함으로써 cpu는 보다 효율적으로 일을 처리할 수 있게 되지만, 단점이 존재한다.

DMA과정에서 DMA 컨트롤러는 시스템 버스를 이용하게 되는데 시스템버스는 공용자원이기 때문에
동시사용이 불가능하다. 따라서 cpu가 시스템버스를 사용할때 DMA컨트롤러는 시스템버스를 이용할 수 없고
DMA 컨트롤러가 시스템 버스를 사용할 때는 cpu가 시스템 버스를 사용할 수 없다.

그래서 DMA 컨트롤러는 cpu가 시스템 버스를 사용하지 않을때마다 조금씩 시스템 버스를 사용하거나
cpu가 일시적으로 시스템버스를 이용하지 않도록 허락을 구하고 시스템 버스를 사용해야 한다.

장치 컨트롤러가 시스템 버스에 직접 연결되는 것은 좋지 않으며 보통 입출력 버스에 연결되어 있다.

<br>

--- 

<br>

### 참조

<br>

[강의] [개발자를 위한 컴퓨터공학 1: 혼자 공부하는 컴퓨터 구조+운영체제](https://www.inflearn.com/course/%ED%98%BC%EC%9E%90-%EA%B3%B5%EB%B6%80%ED%95%98%EB%8A%94-%EC%BB%B4%ED%93%A8%ED%84%B0%EA%B5%AC%EC%A1%B0-%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C)
